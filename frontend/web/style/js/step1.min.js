$(function () {
    $("#upload").click(function () {
        var formData = new FormData();
        formData.append("myfile", document.getElementById("file1").files[0]);
        $.ajax({
            url: check_logo,
            type: "POST",
            data: formData,
            contentType: false,
            processData: false,
            dataType:"json",
            success: function (data) {
                if (data['msg'] == "1") {
                    alert("上传成功！");
                    $("#img").val(data['path']);
                }
                if (data['msg'] == "2") {
                    alert("上传失败!");
                }
            },
            error: function () {
                alert("上传失败！");
            }
        });
    });
    var b, c, a = !1;
  $(document).click(function () {
        var a = [];
        var hh=[];
        $("#box_industry li.current").length > 2 ? alert("行业领域最多可选2个") : ($("#box_industry li.current").each(function () {
                a.push($(this).text())
                hh.push($(this).attr('cid'))
            }), "" == a.join() ? $("#select_industry").val("请选择行业领域") : $("#select_industry").val(a.join()),$("#trade").val(hh.join()), $("#select_industry_hidden").val(a.join()), $("#box_industry").hide()), $("#box_industry").hide(), $("#box_scale").hide(), $("#stagesList .box_invest").hide()
    }), $("#select_industry").bind("click", function (a) {
        a.stopPropagation(), $("#box_industry").show(), $("#box_scale").hide(), $("#stagesList .box_invest").hide()
    }), $("#box_industry").on("click", "ul li", function (a) {
        a.stopPropagation();
        var b = [];
        var ss=[];
        $(this).hasClass("current") ? ($(this).removeClass("current"), $("#box_industry li.current").each(function () {
                b.push($(this).text())
                ss.push($(this).attr("cid"))
            }), $("#select_industry").val(b.join()), $("#trade").val(ss.join()),$("#select_industry_hidden").val(b.join())) : 0 == $(this).siblings("li.current").length ? ($(this).addClass("current"), b.push($(this).text()), $("#select_industry").val(b.join()), $("#select_industry_hidden").val(b.join())) : 1 == $(this).siblings("li.current").length ? ($(this).addClass("current"), $("#box_industry li.current").each(function () {
                        b.push($(this).text())
                        ss.push($(this).attr("cid"))
                    }), $("#select_industry").val(b.join()), $("#trade").val(ss.join()), $("#select_industry_hidden").val(b.join()), $("#box_industry").hide()) : $(this).siblings("li.current").length >= 2 && alert("行业领域最多可选2个"), $("#stepForm").validate().element("#select_industry_hidden")
    }), $("#select_scale").bind("click", function (a) {
        a.stopPropagation(), $("#box_scale").show(), $("#box_industry").hide(), $("#stagesList .box_invest").hide()
    }), $("#box_scale").on("click", "ul li", function (a) {
        a.stopPropagation();
        var b = $(this).text();
        var zz=$(this).attr("cid");
        $("#select_scale,#select_scale_hidden").val(b), $("#scale").val(zz),$("#box_scale").hide(), $("#stepForm").validate().element("#select_scale_hidden")
    }), $("#box_industry,#box_scale").bind("click", function (a) {
        a.stopPropagation()
    }), $("#stepForm").validate({
        onkeyup: !1,
        rules: {
            name: {required: !0, maxlenStr: 100},
            myfiles: {required: !1},
            website: {required: !0, maxlength: 120},
            city: {required: !0,  maxlenStr: 20},
            scale: {required: !0},
            trade: {required: !0},
            message: {required: !0, minlength: 5, maxlenStr: 50}
        },
        messages: {
            name: {required: "请输入有效的公司简称",  maxlenStr: "请输入100字以内的公司简称"},
            website: {required: "请输入公司网址，如：www.lagou.com",  maxlength: "请输入120字符以内的网址"},
            city: {required: "请输入公司所在城市，如：北京", maxlenStr: "请输入有效的公司所在城市"},
            trade: {required: "请选择公司行业领域"},
            scale: {required: "请选择公司规模"},
            message: {
                required: "请一句话概括公司亮点，如：公司愿景、领导团队等，限50字",
                minlength: "请输入5-50字的一句话介绍",
                maxlenStr: "请输入5-50字的一句话介绍"
            }
        },
        submitHandler: function (b) {
            var c, d, e, f, g, h, i, j, k, l, m, n, o,x,y;
            a = !0, c = $("#companyId").val(), d = $("#companyName").val(), e = $("#name").val(), f = $("#img").val(), g = $("#website").val(), "http://" != g.substring(0, 7) && (g = "http://" + g), h = $("#city").val(), i = $("#select_industry_hidden").val(), j = $("#select_scale_hidden").val(), x = $("#scale").val(), y = $("#trade").val() ,o = $("#temptation").val(), $(b).find(":submit").attr("disabled", !0), $.ajax({
                type: "POST",
                data: {
                    companyId: c,
                    companyName: d,
                    companyShortName: e,
                    logo: f,
                    companyUrl: g,
                    city: h,
                    trade: i,
                    scale: j,
                    trade_id:y,
                    scale_id:x,
                    message: o
                },
                url: improve1
            }).done(function (a) {
                if(a==1){
                    window.location.href = improve2+"&companyid="+c;
                }
            })
        }
    })
});